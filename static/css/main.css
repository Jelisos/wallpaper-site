/* 自定义主题颜色 */
:root {
    --color-primary: #1A73E8;
    --color-secondary: #4285F4;
    --color-accent: #8AB4F8;
    --color-neutral: #F0F2F5;
    --color-neutral-dark: #E0E3E9;
    --color-dark: #333333;
    --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --card-shadow-hover: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}

/* 自定义工具类 */
.content-auto {
    content-visibility: auto;
}

/* 瀑布流布局 */
.masonry-grid {
    column-count: 1;
    column-gap: 1rem;
}

@media (min-width: 768px) {
    .masonry-grid {
        column-count: 2;
    }
}

@media (min-width: 1024px) {
    .masonry-grid {
        column-count: 3;
    }
}

@media (min-width: 1280px) {
    .masonry-grid {
        column-count: 4;
    }
}

.masonry-item {
    break-inside: avoid;
    margin-bottom: 1rem;
    max-width: 100%;
}

/* 背景模糊效果 */
.bg-blur {
    backdrop-filter: blur(8px);
}

/* 过渡动画 */
.transition-transform-opacity {
    transition-property: transform, opacity;
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    transition-duration: 300ms;
}

/* 预览按钮样式 */
.preview-btn {
    background-color: #8B5CF6;
}

.preview-btn:hover {
    background-color: #7C3AED;
}

/* 修改：列表视图布局改为瀑布流 - 2024-12-19 */
.list-view-grid {
    column-count: 1;
    column-gap: 1rem;
}

@media (min-width: 768px) {
    .list-view-grid {
        column-count: 2;
    }
}

@media (min-width: 1024px) {
    .list-view-grid {
        column-count: 3;
    }
}

@media (min-width: 1280px) {
    .list-view-grid {
        column-count: 3;
    }
}

/* 修改：流放视图改为瀑布流布局，每行四张图 - 2024-12-19 */
.exiled-view-grid {
    column-count: 1;
    column-gap: 1rem;
}

@media (min-width: 768px) {
    .exiled-view-grid {
        column-count: 2;
    }
}

@media (min-width: 1024px) {
    .exiled-view-grid {
        column-count: 3;
    }
}

@media (min-width: 1280px) {
    .exiled-view-grid {
        column-count: 4;
    }
}

/* 卡片阴影 */
.card-shadow {
    box-shadow: var(--card-shadow);
}

.card-shadow-hover {
    box-shadow: var(--card-shadow-hover);
}

/* 模态框动画 */
.modal-content {
    transform: scale(0.95);
    opacity: 0;
    transition: transform 300ms ease, opacity 300ms ease;
}

.modal-content.show {
    transform: scale(1);
    opacity: 1;
}

/* 模态框样式 */
.modal {
    display: none;
    align-items: center;
    justify-content: center;
    position: fixed;
    z-index: 50;
    visibility: hidden;
    opacity: 0;
}

.modal.show {
    display: flex;
    visibility: visible;
    opacity: 1;
}

/* 确保隐藏的模态框不会影响页面交互 */
.modal.hidden {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    pointer-events: none !important;
}

/* 模态框背景 */
.modal.bg-black\/50 {
    background-color: rgba(0, 0, 0, 0.5);
}

.modal.bg-black\/80 {
    background-color: rgba(0, 0, 0, 0.8);
}

/* 上传模态框优化 */
#upload-modal {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1rem;
}

#upload-modal-content {
    max-height: 90vh;
    overflow-y: auto;
    margin: auto;
    position: relative;
}

/* 添加分类模态框优化 */
#add-category-modal {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1rem;
}

#add-category-modal-content {
    margin: auto;
    position: relative;
}

/* 壁纸详情模态框优化 */
#wallpaper-detail-modal {
    padding: 1rem;
    box-sizing: border-box;
}

#wallpaper-detail-modal-content {
    background: white;
    border-radius: 1rem;
    /* 2024-07-25 调试: 暂时注释掉阴影，排除性能问题 */
    /* box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); */
    /* 2024-07-25 还原: 恢复max-height和overflow-y，确保布局和滚动正常 */
    max-height: 90vh;
    overflow-y: auto;
    width: 100%;
    max-width: 72rem; /* 6xl */
    margin: auto;
    position: relative;
}

/* 模态框内容区域 */
.modal-grid {
    /* 2024-07-25 还原: 恢复grid布局 */
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    padding: 2rem;
    min-height: 0; /* 允许子元素收缩 */
}

/* 图片容器 */
.modal-image-container {
    display: flex;
    flex-direction: column;
    min-height: 0;
}

.modal-image-wrapper {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    /* 2024-07-29 修复: 移除调试背景色 */
    background: none; /* 或设置为你期望的默认背景色，例如 #f8fafc */
    border-radius: 0.75rem;
    overflow: hidden;
}

.modal-image {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    border-radius: 0.5rem;
    /* 2024-07-29 修复: 移除调试背景色 */
    background: none; /* 确保图片本身没有背景色 */
}

/* 2024-07-30 修复: 确保首页图片在瀑布流中正确缩放 */
.card-image {
    width: 100%;
    height: auto;
    display: block;
}

/* 2024-12-19 新增：确保所有视图模式下的卡片都使用瀑布流布局 */
.list-view-grid .masonry-item,
.exiled-view-grid .masonry-item {
    break-inside: avoid;
    margin-bottom: 1rem;
    max-width: 100%;
}

/* 2024-12-19 修复：解决图片高度不够导致的留白问题 */
.wallpaper-card-item img {
    width: 100%;
    height: auto;
    display: block;
    object-fit: cover;
}

/* 2024-12-19 修复：确保占位符高度自适应 */
.wallpaper-card-item .animate-pulse {
    min-height: 200px;
    height: auto;
}

/* 详情容器 */
.modal-details-container {
    display: flex;
    flex-direction: column;
    min-height: 0;
    /* 2024-07-25 还原: 恢复overflow-y */
    overflow-y: auto;
}

/* 提示词区域样式 */
.prompt-section {
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 0.75rem;
    padding: 1rem;
    margin-top: 1rem;
}

.prompt-content {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 0.5rem;
    padding: 0.75rem;
    min-height: 80px;
    max-height: 200px;
    overflow-y: auto;
    font-size: 0.875rem;
    line-height: 1.5;
    color: #374151;
}

.prompt-textarea {
    width: 100%;
    min-height: 120px;
    max-height: 200px;
    resize: vertical;
    border: 1px solid #d1d5db;
    border-radius: 0.5rem;
    padding: 0.75rem;
    font-size: 0.875rem;
    line-height: 1.5;
    font-family: inherit;
}

.prompt-textarea:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.1);
}

/* 锁定状态指示器 */
/* TODO: 删除.lock-indicator相关样式，保留.prompt-section等提示词样式。 */

/* 响应式设计 */
@media (max-width: 1024px) {
    .modal-grid {
        grid-template-columns: 1fr;
        gap: 1.5rem;
        padding: 1.5rem;
    }
    
    .modal-image-wrapper {
        max-height: 50vh;
    }
    
    #wallpaper-detail-modal-content {
        max-width: 95vw;
        max-height: 95vh;
    }
}

@media (max-width: 768px) {
    #wallpaper-detail-modal {
        padding: 0.5rem;
    }
    
    .modal-grid {
        padding: 1rem;
        gap: 1rem;
    }
    
    .modal-image-wrapper {
        min-height: 200px;
        max-height: 40vh;
    }
    
    #wallpaper-detail-modal-content {
        max-width: 98vw;
        max-height: 98vh;
    }
}

/* 滚动条样式 */
#wallpaper-detail-modal-content::-webkit-scrollbar,
.modal-details-container::-webkit-scrollbar,
.prompt-content::-webkit-scrollbar,
.prompt-textarea::-webkit-scrollbar {
    width: 6px;
}

#wallpaper-detail-modal-content::-webkit-scrollbar-track,
.modal-details-container::-webkit-scrollbar-track,
.prompt-content::-webkit-scrollbar-track,
.prompt-textarea::-webkit-scrollbar-track {
    background: #f1f5f9;
    border-radius: 3px;
}

#wallpaper-detail-modal-content::-webkit-scrollbar-thumb,
.modal-details-container::-webkit-scrollbar-thumb,
.prompt-content::-webkit-scrollbar-thumb,
.prompt-textarea::-webkit-scrollbar-thumb {
    background: #cbd5e1;
    border-radius: 3px;
}

#wallpaper-detail-modal-content::-webkit-scrollbar-thumb:hover,
.modal-details-container::-webkit-scrollbar-thumb:hover,
.prompt-content::-webkit-scrollbar-thumb:hover,
.prompt-textarea::-webkit-scrollbar-thumb:hover {
    background: #94a3b8;
}

/* 输入框焦点样式 */
input:focus, select:focus, textarea:focus {
    outline: none;
    ring: 2px;
    ring-color: var(--color-primary);
    ring-opacity: 0.5;
    border-color: var(--color-primary);
}

/* 主要按钮样式 */
.btn-primary {
    background-color: var(--color-primary) !important;
    color: white !important;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 0.5rem;
    font-weight: 500;
    transition: all 0.3s ease;
    cursor: pointer;
}

.btn-primary:hover {
    background-color: var(--color-primary-dark, #7C3AED) !important;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
}

/* 确保所有按钮都有正确的样式 */
button {
    cursor: pointer;
}

/* 上传按钮特殊样式 */
#upload-btn, #mobile-upload-btn {
    background-color: var(--color-primary) !important;
    color: white !important;
    border: 2px solid var(--color-primary) !important;
}

#upload-btn:hover, #mobile-upload-btn:hover {
    background-color: var(--color-primary-dark, #7C3AED) !important;
    border-color: var(--color-primary-dark, #7C3AED) !important;
}

/* 下载按钮样式 */
#download-btn {
    background-color: var(--color-primary) !important;
    color: white !important;
    border: 2px solid var(--color-primary) !important;
}

#download-btn:hover {
    background-color: var(--color-primary-dark, #7C3AED) !important;
    border-color: var(--color-primary-dark, #7C3AED) !important;
}

/* 模态框内按钮样式 */
#browse-files-btn, #submit-upload-btn {
    background-color: var(--color-primary) !important;
    color: white !important;
    border: 2px solid var(--color-primary) !important;
}

#browse-files-btn:hover, #submit-upload-btn:hover {
    background-color: var(--color-primary-dark, #7C3AED) !important;
    border-color: var(--color-primary-dark, #7C3AED) !important;
}

/* Tailwind CSS bg-primary 类定义 */
.bg-primary {
    background-color: var(--color-primary) !important;
}

.bg-primary:hover,
.hover\:bg-primary\/90:hover {
    background-color: rgba(26, 115, 232, 0.9) !important;
}

/* 确保按钮文字颜色正确 */
.bg-primary {
    color: white !important;
}

/* 分类按钮样式 */
.bg-white {
    background-color: white !important;
    color: #333333 !important;
}

.hover\:bg-neutral-dark:hover {
    background-color: var(--color-neutral-dark) !important;
}

/* 字体设置 */
body {
    font-family: 'Inter', system-ui, -apple-system, sans-serif;
    background-color: var(--color-neutral);
    color: var(--color-dark);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    overflow-x: hidden;
}

/* 模态框打开时防止页面抖动 */
body.modal-open {
    overflow: hidden;
    padding-right: var(--scrollbar-width, 0);
}

/* 2024-07-28 新增：流放/召回按钮样式 */
.card-exile-recall-btn {
    /* 确保按钮在卡片内右侧，与收藏/点赞按钮对齐 */
    position: absolute;
    top: 2px; /* 与其他按钮的top保持一致 */
    /* right值需要调整，使其位于点赞按钮的左侧或右侧，根据图标大小和间距调整 */
    right: 70px; /* 假设点赞按钮在 right: 10px, 自身宽度约24px，留出间距 */
    /* 默认样式 */
    padding: 0.5rem; /* p-2 */
    border-radius: 9999px; /* rounded-full */
    background-color: rgba(255, 255, 255, 0.8); /* bg-white/80 */
    backdrop-filter: blur(4px); /* backdrop-blur-sm */
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); /* shadow-sm */
    color: #6B7280; /* text-gray-500 */
    transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    transition-duration: 150ms;
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: center;
}

.card-exile-recall-btn:hover {
    color: #EF4444; /* hover:text-red-500 */
}

.card-exile-recall-btn img {
    width: 20px; /* w-5 */
    height: 20px; /* h-5 */
}

/* 2024-07-28 调整：确保壁纸卡片标题的文本截断 */
.wallpaper-card-item h3 {
    max-width: calc(100% - 40px); /* 留出右侧流放/召回按钮的空间 */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* 2024-07-28 新增：流放图片按钮样式 */
#exiled-list-view-btn img {
    width: 16px; /* w-4 */
    height: 16px; /* h-4 */
}